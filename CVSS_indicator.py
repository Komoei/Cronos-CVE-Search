#! /usr/bin/python3.2

import sys
import time
import subprocess
import os

for line in sys.stdin :
  proc =os.popen('python3.2 adulau/search.py -p '+line[4:-1]+' | grep CVSS').read()
	tab_cvss=[]
	n=proc.find('\n')
	maxi=0.0;
	while(n>0):
		f=proc[0:n].find(':')
		if float(proc[f+2:n])>maxi :	
			maxi=float(proc[f+2:n])
		tab_cvss.append(float(proc[f+2:n]))
		proc=proc[n+1:]
		n=proc.find('\n')
	moyenne=sum(tab_cvss)/len(tab_cvss)
	#for i in range (0,len(tab_cvss)):
		#print (tab_cvss[i])

	print (line[:-1]," cvss maximum:",maxi," cvss moyen: %.1f" % moyenne)
			
