from scapy.all import *


from HTTP import *

test=rdpcap("test.pcap")

i=0
ip=[]
for p in test.filter(lambda(s): HTTPrequest in s or HTTPresponse in s):
  if p[4].name == "HTTP Request" :
		if p[1].src +'|'+p.UserAgent[:-1] not in ip :
			ip.append( p[1].src +'|'+p.UserAgent[:-1])
	elif p[4].name == "HTTP Response" : 
		if p.Server is None:
			if p[1].src+ '|' not in ip :
				ip.append( p[1].src+ '|')
		else :
			if p[1].src+'|'+p.Server[:-1] not in ip :
				ip.append(p[1].src+'|'+p.Server[:-1])

for case in ip:
	print case
